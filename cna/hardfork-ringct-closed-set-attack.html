<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Closed Set Attack - CryptoNote Transaction Graph Analysis</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="custom.css">

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="introduction.html">Introduction</a></li><li class="chapter-item expanded affix "><a href="requirements.html">Requirements</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Monero Analysis</li><li class="chapter-item expanded "><a href="download-blockchain.html"><strong aria-hidden="true">1.</strong> Download the Monero Blockchain</a></li><li class="chapter-item expanded "><a href="postgresql.html"><strong aria-hidden="true">2.</strong> Create PostgreSQL Tables</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="pg-keyimage.html"><strong aria-hidden="true">2.1.</strong> Create Key Image Table</a></li><li class="chapter-item expanded "><a href="pg-outputs.html"><strong aria-hidden="true">2.2.</strong> Create Outputs Table</a></li><li class="chapter-item expanded "><a href="pg-edges.html"><strong aria-hidden="true">2.3.</strong> Create Edges Table</a></li></ol></li><li class="chapter-item expanded "><a href="create-graph.html"><strong aria-hidden="true">3.</strong> Create the Transaction Graph</a></li><li class="chapter-item expanded "><a href="dm-decomposition.html"><strong aria-hidden="true">4.</strong> DM Decomposition Analysis</a></li><li class="chapter-item expanded "><a href="closed-set-attack.html"><strong aria-hidden="true">5.</strong> Closed Set Attack</a></li><li class="chapter-item expanded affix "><li class="part-title">Analysing Monero using Hard Forks</li><li class="chapter-item expanded "><a href="hardforks.html"><strong aria-hidden="true">6.</strong> What and Why of Hard Forks</a></li><li class="chapter-item expanded "><a href="create-fork-indices-column.html"><strong aria-hidden="true">7.</strong> Create Fork Indices Column</a></li><li class="chapter-item expanded "><a href="download-hardforks.html"><strong aria-hidden="true">8.</strong> Download Hard Fork Data</a></li><li class="chapter-item expanded "><a href="monero-original/index.html"><strong aria-hidden="true">9.</strong> Use Monero Original Data</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="monero-original/run-client.html"><strong aria-hidden="true">9.1.</strong> Run Monero Original Client</a></li><li class="chapter-item expanded "><a href="monero-original/postgresql.html"><strong aria-hidden="true">9.2.</strong> Create PostgreSQL Tables</a></li><li class="chapter-item expanded "><a href="monero-original/output-addresses.html"><strong aria-hidden="true">9.3.</strong> Find Output Addresses</a></li><li class="chapter-item expanded "><a href="monero-original/ring-intersections.html"><strong aria-hidden="true">9.4.</strong> Find Ring Intersections</a></li></ol></li><li class="chapter-item expanded "><a href="monerov/index.html"><strong aria-hidden="true">10.</strong> Use MoneroV Data</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="monerov/compile-client.html"><strong aria-hidden="true">10.1.</strong> Compile MoneroV Client</a></li><li class="chapter-item expanded "><a href="monerov/run-client.html"><strong aria-hidden="true">10.2.</strong> Run MoneroV Client</a></li><li class="chapter-item expanded "><a href="monerov/postgresql.html"><strong aria-hidden="true">10.3.</strong> Create PostgreSQL Tables</a></li><li class="chapter-item expanded "><a href="monerov/output-addresses.html"><strong aria-hidden="true">10.4.</strong> Find Output Addresses</a></li><li class="chapter-item expanded "><a href="monerov/ring-intersections.html"><strong aria-hidden="true">10.5.</strong> Find Ring Intersections</a></li></ol></li><li class="chapter-item expanded "><a href="monero-v7/index.html"><strong aria-hidden="true">11.</strong> Use Monero v7 Data</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="monero-v7/run-client.html"><strong aria-hidden="true">11.1.</strong> Run Monero v7 Client</a></li><li class="chapter-item expanded "><a href="monero-v7/postgresql.html"><strong aria-hidden="true">11.2.</strong> Create PostgreSQL Tables</a></li><li class="chapter-item expanded "><a href="monero-v7/output-addresses.html"><strong aria-hidden="true">11.3.</strong> Find Output Addresses</a></li><li class="chapter-item expanded "><a href="monero-v7/ring-intersections.html"><strong aria-hidden="true">11.4.</strong> Find Ring Intersections</a></li></ol></li><li class="chapter-item expanded "><a href="monero-v9/index.html"><strong aria-hidden="true">12.</strong> Use Monero v9 Data</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="monero-v9/run-client.html"><strong aria-hidden="true">12.1.</strong> Run Monero v9 Client</a></li><li class="chapter-item expanded "><a href="monero-v9/postgresql.html"><strong aria-hidden="true">12.2.</strong> Create PostgreSQL Tables</a></li><li class="chapter-item expanded "><a href="monero-v9/output-addresses.html"><strong aria-hidden="true">12.3.</strong> Find Output Addresses</a></li><li class="chapter-item expanded "><a href="monero-v9/ring-intersections.html"><strong aria-hidden="true">12.4.</strong> Find Ring Intersections</a></li></ol></li><li class="chapter-item expanded "><a href="update-fork-indices-column.html"><strong aria-hidden="true">13.</strong> Update Fork Indices Column</a></li><li class="chapter-item expanded "><a href="hardfork-ringct.html"><strong aria-hidden="true">14.</strong> RingCT Analysis</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="hardfork-ringct-edges.html"><strong aria-hidden="true">14.1.</strong> Create Edges Table</a></li><li class="chapter-item expanded "><a href="hardfork-ringct-create-graph.html"><strong aria-hidden="true">14.2.</strong> Create the Transaction Graph</a></li><li class="chapter-item expanded "><a href="hardfork-ringct-dm-decomposition.html"><strong aria-hidden="true">14.3.</strong> DM Decomposition Analysis</a></li><li class="chapter-item expanded "><a href="hardfork-ringct-closed-set-attack.html" class="active"><strong aria-hidden="true">14.4.</strong> Closed Set Attack</a></li></ol></li><li class="chapter-item expanded "><a href="hardfork-nonringct.html"><strong aria-hidden="true">15.</strong> Non-RingCT Analysis</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="hardfork-nonringct-edges.html"><strong aria-hidden="true">15.1.</strong> Create Edges Table</a></li><li class="chapter-item expanded "><a href="hardfork-nonringct-create-graph.html"><strong aria-hidden="true">15.2.</strong> Create the Transaction Graph</a></li><li class="chapter-item expanded "><a href="hardfork-nonringct-dm-decomposition.html"><strong aria-hidden="true">15.3.</strong> DM Decomposition Analysis</a></li><li class="chapter-item expanded "><a href="hardfork-nonringct-closed-set-attack.html"><strong aria-hidden="true">15.4.</strong> Closed Set Attack</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">CryptoNote Transaction Graph Analysis</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="closed-set-attack"><a class="header" href="#closed-set-attack">Closed Set Attack</a></h1>
<ol>
<li>
<p>Compile the Rust binaries by running <code>cargo build --release</code> (if not already done).</p>
</li>
<li>
<p>Perform the cascade attack first by running the following command.</p>
<pre><code>cargo run --release --bin cascade fork-ringct-csparse-edges-2530000.txt fork-ringct-rings-after-cascade-2530000.txt 10
</code></pre>
<blockquote>
<p><strong>Note</strong>: The significance of the arguments to <code>cascade</code> can be understood by running <code>cargo run -r --bin cascade -- --help</code> or <code> ./target/release/cascade --help</code>.</p>
</blockquote>
<p>The output should look like the following.</p>
<pre><code>Edge file read in 59.538947568s
Num keyimages = 40351733, Num public keys = 45805316
Zero-mixin rings before CA = 63060
Zero-mixin rings after CA iteration 1 = 63115. Time taken = 232.824592ms.
Zero-mixin rings after CA iteration 2 = 63115. Time taken = 142.609136ms.
No change in number of traceable rings. Exiting cascade attack loop
</code></pre>
<p>The above output shows that 63115 rings were traced by the cascade attack after the first iteration. As there was no change in the number of traceable rings in the second iteration, the program exited.</p>
<blockquote>
<p><strong>Note:</strong> The alert reader would have noticed that the number of rings traced by the cascade attack (63115) is equal to the number of rings traced by the <a href="./hardfork-dm-decomposition.html">DM decomposition</a>. As the DM decomposition achieves the best possible traceability performance, running the clustering algorithm can only hope to identify the closed set of size 5.</p>
</blockquote>
</li>
<li>
<p>Run the clustering algorithm attack by running the following command.</p>
<pre><code>cargo run --release --bin cluster fork-ringct-rings-after-cascade-2530000.txt fork-ringct-rings-after-cluster-2530000.txt
</code></pre>
<blockquote>
<p><strong>Note</strong>: The significance of the arguments to <code>cluster</code> can be understood by running <code>cargo run -r --bin cluster -- --help</code> or <code> ./target/release/cluster --help</code>.</p>
</blockquote>
<p>The output should look like the following.</p>
<pre><code>Rings file read in 60.661705933s
Ring sets created in 10.862469778s
Counted initial number of traceable rings in 120.226064ms
Number of traceable rings = 63115
At beginning of clustering algorithm while loop
1: Cluster of size 5 found at key index 3313858. Search iteration = 1
Number of blocks in fine decomposition: 1
Singletons (traceable keyimages): 0
Number of traceable rings = 63115
Number of closed sets = 1
Number of singleton closed sets = 0
Number of non-singleton closed sets = 1
Closed set size histogram: {5: 1}
Number of public keys in all sets = 5
Number of public keys in non-singleton closed sets = 5
At beginning of clustering algorithm while loop
1: Cluster of size 5 found at key index 3313858. Search iteration = 2
Number of blocks in fine decomposition: 1
Singletons (traceable keyimages): 0
Number of traceable rings = 63115
Number of closed sets = 1
Number of singleton closed sets = 0
Number of non-singleton closed sets = 1
Closed set size histogram: {5: 1}
Number of public keys in all sets = 5
Number of public keys in non-singleton closed sets = 5
Pre attack mixin histogram:
 [63115, 5224, 1556095, 213486, 2251516, 241583, 1515510, 285536, 52644, 62841, 34104183]
Post attack mixin histogram:
 [63115, 5224, 1556096, 213498, 2251506, 241582, 1515511, 285533, 52644, 62843, 34104181]
</code></pre>
<blockquote>
<p><strong>Note:</strong> The clustering algorithm for this data set can take a long time to finish running. It took 64 hours on our test machine. In contrast, the DM decomposition took 4 hours.
The above output can be interpreted as follows.</p>
</blockquote>
<ul>
<li>The clustering algorithm does not find any singleton closed sets, other than the 63115 traceable rings output by the cascade attack. The DM decomposition had also rendered 63115 rings traceable. So it does not give better traceability performance for this dataset (except for the shorter running time).</li>
<li>There is a single closed set of size 5 that was also found by the DM decomposition.</li>
</ul>
</li>
<li>
<p>To calculate statistics related to the clustering algorithm, run the following command.</p>
<pre><code>cargo run --release --bin stats_cla fork-ringct-csparse-edges-2530000.txt fork-ringct-rings-after-cascade-2530000.txt fork-ringct-rings-after-cluster-2530000.txt
</code></pre>
<blockquote>
<p><strong>Note</strong>: The significance of the arguments to <code>stats_cla</code> can be understood by running <code>cargo run -r --bin stats_cla -- --help</code> or <code> ./target/release/stats_cla --help</code>.</p>
</blockquote>
<p>The output should look like the following.</p>
<pre><code>Edge file read in 50.216200804s
Num keyimages = 40351733, Num public keys = 45805316
Initial mixin histogram:
[63060, 1214, 1556222, 141805, 2313832, 179183, 1577210, 294913, 55131, 16364, 34152799]
Post cascade attack rings file read in 62.181589318s
Post cascade attack mixin histogram:
[63115, 5224, 1556095, 213486, 2251516, 241583, 1515510, 285536, 52644, 62841, 34104183]
Cascade traceable ring pre-attack mixin histogram:
[63060, 40, 9, 0, 5, 0, 1, 0, 0, 0, 0]
Pre-attack mixin histogram of rings traced by cascade attack
0 63060
1 40
2 9
3 0
4 5
5 0
6 1
7 0
8 0
9 0
10 0
Total number of rings traced by cascade attack = 63115
Post clustering algorithm rings file read in 62.854710385s
Post clustering algorithm mixin histogram:
[63115, 5224, 1556096, 213498, 2251506, 241582, 1515511, 285533, 52644, 62843, 34104181]
Cluster traceable ring post-attack mixin histogram:
[63060, 40, 9, 0, 5, 0, 1, 0, 0, 0, 0]
Post-attack mixin histogram of rings traced by clustering algorithm
0 0
1 0
2 0
3 0
4 0
5 0
6 0
7 0
8 0
9 0
10 0
Total number of rings traced by clustering algorithm = 0
</code></pre>
<p>The above output can be interpreted as follows.</p>
<ul>
<li>Out of the 63115 rings traced by the cascade attack, 63060 had zero mixins (there were already traceable) before the attack, 40 had one mixin before the attack, 9 had two mixins, and so on.</li>
<li>The clustering algorithm was not able to trace any rings over and above those traced by the cascade attack.</li>
</ul>
</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="hardfork-ringct-dm-decomposition.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="hardfork-nonringct.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="hardfork-ringct-dm-decomposition.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="hardfork-nonringct.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
